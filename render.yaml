services:
  - type: web
    name: chess-app
    runtime: node
    
    buildCommand: |
      apt-get update
      apt-get install -y stockfish
      echo "Verifying Stockfish installation..."
      which stockfish && stockfish --version || (echo "ERROR: Stockfish not found" && exit 1)
      echo "Installing dependencies..."
      npm install --production=false
      cd backend && npm install && cd ..
      echo "Building frontend..."
      npm run build

    startCommand: cd backend && npm start

    envVars:
      - key: PORT
        value: 3001
      - key: NODE_ENV
        value: production
