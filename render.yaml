services:
  - type: web
    name: chess-app
    runtime: node
    
    buildCommand: |
      apt-get update
      apt-get install -y stockfish
      STOCKFISH_PATH=$(which stockfish)
      echo "Stockfish found at: $STOCKFISH_PATH"
      chmod +x $STOCKFISH_PATH
      npm install --production=false
      cd backend && npm install && cd ..
      npm run build

    startCommand: cd backend && npm start

    envVars:
      - key: PORT
        value: 3001
      - key: NODE_ENV
        value: production
